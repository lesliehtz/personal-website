---
interface Props {
  series?: Array<{ title: string; slug: string }>;
}

const { series = [] } = Astro.props;
const currentPath = Astro.url.pathname;
---

<button class="hamburger" aria-label="Menu">
  <svg
    width="2rem"
    height="2rem"
    viewBox="0 0 24 18"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      d="M0 1.5h24M0 9h24M0 16.5h24"
      stroke="currentColor"
      stroke-width="2.5"
      stroke-linecap="square"></path>
  </svg>
</button>

<div class="mobile-nav">
  <nav>
    <div class="menu-section">
      <a href="/" class="menu-label">Series</a>
      {
        series.length > 0 && (
          <ul class="series-list">
            {series.map((item) => (
              <li>
                <a
                  href={`/series/${item.slug}`}
                  class:list={[
                    { active: currentPath === `/series/${item.slug}` },
                  ]}
                >
                  {item.title}
                </a>
              </li>
            ))}
          </ul>
        )
      }
    </div>

    <div class="menu-section">
      <a href="/about" class:list={[{ active: currentPath === '/about' }]}>
        About
      </a>
    </div>

    <div class="menu-section">
      <a
        href="#"
        class="contact-link"
        data-user="heintz.leslie"
        data-domain="gmail.com"
      >
        Contact
      </a>
    </div>
  </nav>
</div>

<style>
  .hamburger {
    background: none;
    border: none;
    cursor: pointer;
    padding: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #222;
    width: 2rem;
    height: 2rem;
    flex-shrink: 0;
  }

  .hamburger:hover {
    color: #444;
  }

  .mobile-nav {
    --mobile-menu-font-size: 1.3rem;
    --mobile-menu-spacing: 0.5rem;
    display: none;
    position: fixed;
    top: 5rem;
    left: 0;
    right: 0;
    bottom: 0;
    background: white;
    padding: 1rem;
    z-index: 99;
    text-align: right;
    font-size: var(--mobile-menu-font-size);
  }

  .mobile-nav.open {
    display: block;
  }

  .menu-section {
    margin-bottom: 2.5rem;
  }

  .menu-label {
    display: block;
    margin-bottom: var(--mobile-menu-spacing);
  }

  .series-list {
    list-style: none;
    padding-right: 2rem;
    text-align: right;
  }

  .series-list li {
    margin-bottom: var(--mobile-menu-spacing);
  }

  .active {
    font-weight: 600;
  }
</style>

<script>
  const hamburger = document.querySelector('.hamburger');
  const mobileNav = document.querySelector('.mobile-nav');

  hamburger?.addEventListener('click', () => {
    mobileNav?.classList.toggle('open');
  });

  // Set up contact email link
  document.addEventListener('DOMContentLoaded', () => {
    const contactLink = document.querySelector('.contact-link');
    if (contactLink) {
      const user = contactLink.getAttribute('data-user');
      const domain = contactLink.getAttribute('data-domain');
      contactLink.setAttribute('href', `mailto:${user}@${domain}`);
    }
  });
</script>
